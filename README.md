# ğŸŒ± AI Batake App

AIã‚’æ´»ç”¨ã—ãŸã‚¹ãƒãƒ¼ãƒˆè¾²æ¥­ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã™ã€‚ã‚»ãƒ³ã‚µãƒ¼ãƒ‡ãƒ¼ã‚¿ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–ã€ç¨®è¢‹ç”»åƒã‹ã‚‰ã®æ ½åŸ¹æƒ…å ±ã®è‡ªå‹•æŠ½å‡ºã€ãŠã‚ˆã³AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«ã‚ˆã‚‹æ ½åŸ¹ã‚¬ã‚¤ãƒ‰ã®ç”Ÿæˆã‚’è¡Œã„ã¾ã™ã€‚

## ğŸ“‹ æ¦‚è¦

AI Batake Appã¯ã€å®¶åº­èœåœ’ã‚„è¾²æ¥­ã‚’æ”¯æ´ã™ã‚‹ãŸã‚ã®AIãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã™ã€‚ä»¥ä¸‹ã®æ©Ÿèƒ½ã‚’æä¾›ã—ã¾ã™ï¼š

- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç’°å¢ƒç›£è¦–**: æ¸©åº¦ã€æ¹¿åº¦ã€åœŸå£Œæ°´åˆ†ãªã©ã®ã‚»ãƒ³ã‚µãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§å¯è¦–åŒ–
- **ç¨®è¢‹ç”»åƒè§£æ**: AIã«ã‚ˆã‚‹ç¨®è¢‹ç”»åƒã®è‡ªå‹•åˆ†æã¨æ ½åŸ¹æƒ…å ±ã®æŠ½å‡º
- **Deep Research**: Gemini AIã‚’æ´»ç”¨ã—ãŸè©³ç´°ãªæ ½åŸ¹æ¡ä»¶ã®èª¿æŸ»
- **æ ½åŸ¹ã‚¬ã‚¤ãƒ‰ç”Ÿæˆ**: ã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—ã®æ ½åŸ¹æ‰‹é †ã¨ç”»åƒã®è‡ªå‹•ç”Ÿæˆ

## ğŸ› ï¸ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
| æŠ€è¡“ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | ç”¨é€” |
|------|----------|------|
| Python | 3.11 | ãƒ¡ã‚¤ãƒ³è¨€èª |
| FastAPI | - | Web API ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ |
| Uvicorn | - | ASGI ã‚µãƒ¼ãƒãƒ¼ |
| Google Cloud Firestore | - | NoSQL ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ |
| Google Cloud Storage | - | ç”»åƒã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ |
| Google Vertex AI | - | AI ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆåŸºç›¤ |
| Gemini API | - | ç”»åƒè§£æãƒ»Deep Research |

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
| æŠ€è¡“ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | ç”¨é€” |
|------|----------|------|
| Next.js | 16 | React ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ (App Router) |
| React | 19 | UI ãƒ©ã‚¤ãƒ–ãƒ©ãƒª |
| TypeScript | 5 | å‹å®‰å…¨ãªé–‹ç™º |
| Tailwind CSS | 4 | ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚° |
| Radix UI | - | ã‚¢ã‚¯ã‚»ã‚·ãƒ–ãƒ«ãª UI ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ |
| Recharts | - | ãƒ‡ãƒ¼ã‚¿å¯è¦–åŒ– |

### ã‚¤ãƒ³ãƒ•ãƒ©
| æŠ€è¡“ | ç”¨é€” |
|------|------|
| Docker | ã‚³ãƒ³ãƒ†ãƒŠåŒ– |
| Google Cloud Run | ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ãƒ‡ãƒ—ãƒ­ã‚¤ |

## ğŸ“ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

```
ai-batake-app/
â”œâ”€â”€ backend/                    # Python FastAPI ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
â”‚   â”œâ”€â”€ main.py                # ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ»APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ agent.py               # Vertex AI ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé€£æº
â”‚   â”œâ”€â”€ db.py                  # Firestore ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œ
â”‚   â”œâ”€â”€ research_agent.py      # ç¨®è¢‹è§£æãƒ»Deep Research
â”‚   â”œâ”€â”€ seed_service.py        # éåŒæœŸæ ½åŸ¹ã‚¬ã‚¤ãƒ‰ç”Ÿæˆ
â”‚   â”œâ”€â”€ requirements.txt       # Python ä¾å­˜é–¢ä¿‚
â”‚   â””â”€â”€ tests/                 # ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«
â”‚
â”œâ”€â”€ frontend/                   # Next.js ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
â”‚   â”œâ”€â”€ app/                   # App Router ãƒšãƒ¼ã‚¸
â”‚   â”‚   â”œâ”€â”€ page.tsx          # ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒšãƒ¼ã‚¸
â”‚   â”‚   â”œâ”€â”€ dashboard/        # ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
â”‚   â”‚   â”œâ”€â”€ research_agent/   # Research Agent UI
â”‚   â”‚   â””â”€â”€ seed_guide/       # æ ½åŸ¹ã‚¬ã‚¤ãƒ‰ç”Ÿæˆ UI
â”‚   â”œâ”€â”€ components/            # React ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ ui/               # åŸºæœ¬ UI ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ metric-card.tsx   # ã‚»ãƒ³ã‚µãƒ¼ãƒ¡ãƒˆãƒªã‚¯ã‚¹è¡¨ç¤º
â”‚   â”‚   â”œâ”€â”€ weather-card.tsx  # å¤©æ°—æƒ…å ±è¡¨ç¤º
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ lib/                   # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°
â”‚
â”œâ”€â”€ docs/                       # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”œâ”€â”€ Dockerfile                  # Docker ãƒ“ãƒ«ãƒ‰è¨­å®š
â”œâ”€â”€ start.sh                    # èµ·å‹•ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â””â”€â”€ README.md                   # ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«
```

## ğŸš€ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### å‰ææ¡ä»¶

- Node.js 18ä»¥ä¸Š
- Python 3.11
- Google Cloud ã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼ˆFirestore, Storage, Vertex AI ã®æœ‰åŠ¹åŒ–ï¼‰

### ç’°å¢ƒå¤‰æ•°

ä»¥ä¸‹ã®ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã—ã¦ãã ã•ã„ï¼š

```bash
# Google Cloud
export GOOGLE_CLOUD_PROJECT="your-project-id"
export GOOGLE_APPLICATION_CREDENTIALS="/path/to/service-account.json"

# AI Agent
export AGENT_ENDPOINT="projects/{PROJECT_ID}/locations/us-central1/reasoningEngines/{AGENT_ID}"

# Gemini API (Optional)
export GEMINI_API_KEY="your-api-key"
export SEED_GUIDE_GEMINI_KEY="your-api-key"
```

### ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™º

#### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
```bash
cd backend
pip install -r requirements.txt
uvicorn backend.main:app --host 0.0.0.0 --port 8081 --reload
```

#### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
```bash
cd frontend
npm install --legacy-peer-deps
npm run dev
```

### Docker ãƒ“ãƒ«ãƒ‰
```bash
# ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰
docker build -t ai-batake-app .

# ã‚³ãƒ³ãƒ†ãƒŠã®å®Ÿè¡Œ
docker run -p 8080:8080 -p 8081:8081 ai-batake-app
```

## ğŸ“Š ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“å›³

```mermaid
graph TB
    subgraph "ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ (Next.js)"
        LP[ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒšãƒ¼ã‚¸]
        DB[ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰]
        RA[Research Agent]
        SG[Seed Guide]
    end

    subgraph "ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ (FastAPI)"
        API[API Server<br/>:8081]
        AGT[Agent Module]
        RES[Research Module]
        SEED[Seed Service]
    end

    subgraph "Google Cloud"
        FS[(Firestore)]
        GCS[(Cloud Storage)]
        VAI[Vertex AI<br/>Agent Engine]
        GEM[Gemini API]
    end

    subgraph "ã‚¨ãƒƒã‚¸ãƒ‡ãƒã‚¤ã‚¹"
        SENS[ã‚»ãƒ³ã‚µãƒ¼]
        CAM[ã‚«ãƒ¡ãƒ©]
    end

    LP --> DB
    LP --> RA
    LP --> SG

    DB --> API
    RA --> API
    SG --> API

    API --> AGT
    API --> RES
    API --> SEED

    AGT --> VAI
    RES --> GEM
    SEED --> GEM

    API --> FS
    API --> GCS

    SENS --> FS
    CAM --> GCS
```

### ç¨®è¢‹è§£æãƒ•ãƒ­ãƒ¼

```mermaid
sequenceDiagram
    participant U as ãƒ¦ãƒ¼ã‚¶ãƒ¼
    participant FE as Frontend
    participant BE as Backend
    participant GM as Gemini API
    participant DB as Firestore

    U->>FE: ç¨®è¢‹ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
    FE->>BE: POST /api/register-seed
    BE->>GM: ç”»åƒè§£æãƒªã‚¯ã‚¨ã‚¹ãƒˆ
    GM-->>BE: é‡èœåãƒ»åŸºæœ¬æƒ…å ±
    BE->>DB: ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ä¿å­˜ (processing)
    BE-->>FE: document_id è¿”å´
    
    Note over BE: ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã‚¿ã‚¹ã‚¯
    BE->>GM: Deep Research é–‹å§‹
    GM-->>BE: è©³ç´°æ ½åŸ¹æƒ…å ±
    BE->>DB: çµæœä¿å­˜ (completed)
    
    FE->>BE: GET /api/vegetables (ãƒãƒ¼ãƒªãƒ³ã‚°)
    BE-->>FE: æœ€æ–°ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
    FE->>U: çµæœè¡¨ç¤º
    
    U->>FE: ã€ŒApply to Agentã€ã‚’ã‚¯ãƒªãƒƒã‚¯
    FE->>BE: POST /api/vegetables/{id}/select
    BE->>DB: ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆè¨­å®šæ›´æ–° (edge_agent)
```

### æ ½åŸ¹ã‚¬ã‚¤ãƒ‰ç”Ÿæˆãƒ•ãƒ­ãƒ¼ (éåŒæœŸã‚¸ãƒ§ãƒ–)

```mermaid
sequenceDiagram
    participant U as ãƒ¦ãƒ¼ã‚¶ãƒ¼
    participant FE as Frontend
    participant BE as Backend
    participant GM as Gemini 3 Pro
    participant IMG as Nanobanana Pro
    participant DB as Firestore

    U->>FE: ç¨®è¢‹ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
    FE->>BE: POST /api/seed-guide/jobs
    BE->>DB: ã‚¸ãƒ§ãƒ–ä½œæˆ (PENDING)
    BE-->>FE: job_id è¿”å´

    Note over BE: ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã‚¿ã‚¹ã‚¯
    BE->>DB: ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–° (PROCESSING)
    BE->>GM: ç”»åƒè§£æ + ã‚¹ãƒ†ãƒƒãƒ—ç”Ÿæˆ
    GM-->>BE: æ ½åŸ¹ã‚¹ãƒ†ãƒƒãƒ— (JSON)
    
    loop å„ã‚¹ãƒ†ãƒƒãƒ—
        BE->>IMG: ç”»åƒç”Ÿæˆãƒªã‚¯ã‚¨ã‚¹ãƒˆ
        IMG-->>BE: Base64 ç”»åƒ
    end
    
    BE->>DB: çµæœä¿å­˜ (COMPLETED)

    loop ãƒãƒ¼ãƒªãƒ³ã‚°
        FE->>BE: GET /api/seed-guide/jobs/{job_id}
        BE-->>FE: ã‚¸ãƒ§ãƒ–ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
    end
    
    FE->>U: ã‚¦ã‚£ã‚¶ãƒ¼ãƒ‰å½¢å¼ã§è¡¨ç¤º
```

## ğŸ§ª ãƒ†ã‚¹ãƒˆ

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
```bash
cd backend
pip install pytest pytest-asyncio httpx
pytest
```

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
```bash
cd frontend
npm test
```

è©³ç´°ãªãƒ†ã‚¹ãƒˆæƒ…å ±ã«ã¤ã„ã¦ã¯ [docs/TEST_README.md](docs/TEST_README.md) ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

## ğŸ“± ç”»é¢æ§‹æˆ

| ç”»é¢ | ãƒ‘ã‚¹ | èª¬æ˜ |
|------|-----|------|
| ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚° | `/` | ã‚¢ãƒ—ãƒªæ¦‚è¦ã¨å„æ©Ÿèƒ½ã¸ã®ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ |
| ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ | `/dashboard` | ã‚»ãƒ³ã‚µãƒ¼ãƒ‡ãƒ¼ã‚¿ãƒ»å¤©æ°—ãƒ»æˆé•·æ®µéšã®è¡¨ç¤º |
| Research Agent | `/research_agent` | ç¨®è¢‹è§£æã¨è©³ç´°ãƒªã‚µãƒ¼ãƒ |
| Seed Guide | `/seed_guide` | éåŒæœŸæ ½åŸ¹ã‚¬ã‚¤ãƒ‰ç”Ÿæˆ |

## ğŸ”— API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

| ãƒ¡ã‚½ãƒƒãƒ‰ | ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | èª¬æ˜ |
|---------|---------------|------|
| POST | `/api/weather` | å¤©æ°—æƒ…å ±å–å¾— |
| GET | `/api/sensors/latest` | æœ€æ–°ã‚»ãƒ³ã‚µãƒ¼ãƒ‡ãƒ¼ã‚¿å–å¾— |
| GET | `/api/sensor-history` | ã‚»ãƒ³ã‚µãƒ¼å±¥æ­´å–å¾— |
| GET | `/api/vegetables/latest` | æœ€æ–°é‡èœãƒ‡ãƒ¼ã‚¿å–å¾— |
| GET | `/api/vegetables` | å…¨é‡èœãƒªã‚¹ãƒˆå–å¾— |
| POST | `/api/vegetables/{doc_id}/select` | è‚²æˆæƒ…å ±ã®é¸æŠãƒ»ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé©ç”¨ |
| POST | `/api/register-seed` | ç¨®è¢‹ç™»éŒ²ãƒ»è§£æé–‹å§‹ |
| GET | `/api/plant-camera/latest` | æœ€æ–°æ¤ç‰©ç”»åƒå–å¾— |
| POST | `/api/seed-guide/jobs` | æ ½åŸ¹ã‚¬ã‚¤ãƒ‰ã‚¸ãƒ§ãƒ–ä½œæˆ |
| GET | `/api/seed-guide/jobs/{job_id}` | ã‚¸ãƒ§ãƒ–ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å–å¾— |

## ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

Â© 2025 Smart Farm AI Team

## ğŸ¤ ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³

1. ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’ãƒ•ã‚©ãƒ¼ã‚¯
2. ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ãƒ–ãƒ©ãƒ³ãƒã‚’ä½œæˆ (`git checkout -b feature/amazing-feature`)
3. å¤‰æ›´ã‚’ã‚³ãƒŸãƒƒãƒˆ (`git commit -m 'Add amazing feature'`)
4. ãƒ–ãƒ©ãƒ³ãƒã«ãƒ—ãƒƒã‚·ãƒ¥ (`git push origin feature/amazing-feature`)
5. ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ä½œæˆ
